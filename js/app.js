(()=>{let e=[],t=[],n=[],o=[],l=[],s=[],r=null;const a="https://ddragon.leagueoflegends.com/cdn/img/",i={requiredBootsCount:1,bootsFirst:!0,mutuallyExclusivePairs:[["Manamune","Muramana"]]};function c(){const e=document.getElementById("gameMode").value,s="ARAM"===e?"12":"11";n=l.filter(e=>e.maps&&e.maps[s]),t=o.filter(t=>t.modes&&t.modes.includes(e))}function m(e){return e[Math.floor(Math.random()*e.length)]}function d(e){return Array.isArray(e.tags)&&e.tags.includes("Boots")}function u(e,t,n,o){if(void 0!==n.requiredBootsCount){const o=t.filter(d).length;if(d(e)&&o>=n.requiredBootsCount)return!1}const l=o.get(e.name);if(l)for(const e of t)if(l.has(e.name))return!1;return!0}function y(){if(!e.length||!t.length||!n.length)return null;const o=m(e),l=m(t);let r=m(t);for(;r===l;)r=m(t);let a=function(e,t,n){const o=function(e){const t=new Map;for(const[n,o]of e)t.has(n)||t.set(n,new Set),t.has(o)||t.set(o,new Set),t.get(n).add(o),t.get(o).add(n);return t}(n.mutuallyExclusivePairs||[]),l=[...e],s=[];if(n.bootsFirst){const e=l.filter(e=>d(e)&&u(e,s,n,o));if(!e.length)return null;const t=m(e);s.push(t),l.splice(l.indexOf(t),1)}for(;s.length<t;){const e=l.filter(e=>!d(e)&&u(e,s,n,o));if(!e.length)return null;const t=m(e);s.push(t),l.splice(l.indexOf(t),1)}return s}(n,6,i);if(!a){a=[];const e=[...n],t=e.filter(e=>d(e));if(t.length>0){const n=m(t);a.push(n),e.splice(e.indexOf(n),1)}for(;a.length<6&&e.length>0;){const t=Math.floor(Math.random()*e.length);a.push(e[t]),e.splice(t,1)}}const c=function(){const e=["Q","W","E"];for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}();return{champion:o,spell1:l,spell2:r,items:a,abilityPriority:c.join(" > "),abilityPriorityOrder:c,runePage:function(){if(!Array.isArray(s)||s.length<2)return null;const e=m(s);let t=m(s);for(;t.id===e.id;)t=m(s);const n=(e.slots||[]).map(e=>m(e.runes||[])),o=(t.slots||[]).slice(1),l=[0,1,2].filter(e=>o[e]),r=m(l),a=m(l.filter(e=>e!==r));return{primaryTree:e,secondaryTree:t,primaryRunes:n,secondaryRunes:[m(o[r].runes||[]),m(o[a].runes||[])]}}()}}function g(e){if(!e)return;document.getElementById("championName").textContent=e.champion.name,document.getElementById("championClass").textContent=e.champion.class;const t=document.getElementById("championIcon");t&&e.champion.id&&(t.src=`images/champions/${e.champion.id}.png`,t.alt=e.champion.name,t.style.display="block"),document.getElementById("summonerSpell1").textContent=e.spell1.name;const n=document.getElementById("spell1Icon");n&&e.spell1.id&&(n.src=`images/spells/${e.spell1.id}.png`,n.alt=e.spell1.name,n.style.display="block"),document.getElementById("summonerSpell2").textContent=e.spell2.name;const o=document.getElementById("spell2Icon");o&&e.spell2.id&&(o.src=`images/spells/${e.spell2.id}.png`,o.alt=e.spell2.name,o.style.display="block");for(let t=0;t<6;t++){document.getElementById(`item${t+1}`).textContent=e.items[t].name;const n=document.getElementById(`item${t+1}Icon`);n&&e.items[t].id&&(n.src=`images/items/${e.items[t].id}.png`,n.alt=e.items[t].name,n.style.display="block")}if(document.getElementById("abilityPriority").textContent=e.abilityPriority,e.champion.abilities&&Array.isArray(e.abilityPriorityOrder)&&e.abilityPriorityOrder.forEach((t,n)=>{const o=e.champion.abilities[t],l=document.getElementById(`abilityIcon${n+1}`),s=document.getElementById(`abilityLabel${n+1}`);l&&o&&(l.src=o.icon,l.alt=o.name,l.style.display="block"),s&&(s.textContent=t)}),e.runePage){document.getElementById("runePrimaryName").textContent=e.runePage.primaryTree.name,document.getElementById("runeSecondaryName").textContent=e.runePage.secondaryTree.name;const t=document.getElementById("runePrimaryTreeIcon");t&&(t.src=`${a}${e.runePage.primaryTree.icon}`,t.alt=e.runePage.primaryTree.name,t.style.display="block");const n=document.getElementById("runeSecondaryTreeIcon");n&&(n.src=`${a}${e.runePage.secondaryTree.icon}`,n.alt=e.runePage.secondaryTree.name,n.style.display="block"),e.runePage.primaryRunes.forEach((e,t)=>{const n=document.getElementById(`runePrimary${t+1}`);n&&e&&(n.src=`${a}${e.icon}`,n.alt=e.name,n.style.display="block")}),e.runePage.secondaryRunes.forEach((e,t)=>{const n=document.getElementById(`runeSecondary${t+1}`);n&&e&&(n.src=`${a}${e.icon}`,n.alt=e.name,n.style.display="block")})}document.getElementById("results").style.display="block"}const p=document.getElementById("rollBtn"),f=document.getElementById("rerollBtn");function h(e){p.disabled=!e,f.disabled=!e}p.addEventListener("click",()=>{g(y())}),f.addEventListener("click",()=>{g(y())}),document.getElementById("gameMode").addEventListener("change",()=>{c(),document.getElementById("results").style.display="none"}),async function(){h(!1);try{await async function(){const[t,n,a,i,m]=await Promise.all([fetch("data/champions.json").then(e=>e.json()),fetch("data/summoner-spells.json").then(e=>e.json()),fetch("data/items.json").then(e=>e.json()),fetch("data/runes.json").then(e=>e.json()),fetch("data/metadata.json").then(e=>e.json()).catch(()=>({version:"Unknown"}))]);e=t,o=n,l=a,s=i,r=m,r&&r.version&&(document.getElementById("patchVersion").textContent=`Patch ${r.version}`),c()}(),h(!0)}catch(e){console.error("Failed to load data files.",e)}}()})();