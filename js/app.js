(()=>{let e=[],t=[],n=[],o=[],l=[],s=[],r=null;const a="https://ddragon.leagueoflegends.com/cdn/img/",i={requiredBootsCount:1,bootsFirst:!0,mutuallyExclusiveGroups:[["Ravenous Hydra","Titanic Hydra","Profane Hydra"]],mutuallyExclusivePairs:[["Manamune","Muramana"]]};function c(){const e=document.getElementById("gameMode").value,s="ARAM"===e?"12":"11";n=l.filter(e=>e.maps&&e.maps[s]),t=o.filter(t=>t.modes&&t.modes.includes(e))}function m(e){return e[Math.floor(Math.random()*e.length)]}function d(e){return Array.isArray(e.tags)&&e.tags.includes("Boots")}function u(e,t,n,o,l){if(void 0!==n.requiredBootsCount){const o=t.filter(d).length;if(d(e)&&o>=n.requiredBootsCount)return!1}if(e.rangedOnly&&l&&!l.ranged)return!1;const s=o.get(e.name);if(s)for(const e of t)if(s.has(e.name))return!1;return!0}function y(){if(!e.length||!t.length||!n.length)return null;const o=m(e),l=m(t);let r=m(t);for(;r===l;)r=m(t);let a=function(e,t,n,o){const l=function(e,t){const n=new Map;for(const[t,o]of e||[])n.has(t)||n.set(t,new Set),n.has(o)||n.set(o,new Set),n.get(t).add(o),n.get(o).add(t);for(const e of t||[])for(const t of e){n.has(t)||n.set(t,new Set);for(const o of e)o!==t&&n.get(t).add(o)}return n}(n.mutuallyExclusivePairs||[],n.mutuallyExclusiveGroups||[]),s=[...e],r=[];if(n.bootsFirst){const e=s.filter(e=>d(e)&&u(e,r,n,l,o));if(!e.length)return null;const t=m(e);r.push(t),s.splice(s.indexOf(t),1)}for(;r.length<t;){const e=s.filter(e=>!d(e)&&u(e,r,n,l,o));if(!e.length)return null;const t=m(e);r.push(t),s.splice(s.indexOf(t),1)}return r}(n,6,i,o);if(!a){a=[];const e=n.filter(e=>!e.rangedOnly||o.ranged),t=e.filter(e=>d(e));if(t.length>0){const n=m(t);a.push(n),e.splice(e.indexOf(n),1)}const l=e.filter(e=>!d(e));for(;a.length<6&&l.length>0;){const e=Math.floor(Math.random()*l.length);a.push(l[e]),l.splice(e,1)}}const c=function(){const e=["Q","W","E"];for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}(),y=function(){if(!Array.isArray(s)||s.length<2)return null;const e=m(s);let t=m(s);for(;t.id===e.id;)t=m(s);const n=(e.slots||[]).map(e=>m(e.runes||[])),o=(t.slots||[]).slice(1),l=[0,1,2].filter(e=>o[e]),r=m(l),a=m(l.filter(e=>e!==r));return{primaryTree:e,secondaryTree:t,primaryRunes:n,secondaryRunes:[m(o[r].runes||[]),m(o[a].runes||[])]}}();return{champion:o,spell1:l,spell2:r,items:a,abilityPriorityOrder:c,runePage:y}}const g=document.getElementById("rollBtn");function p(e){g.disabled=!e}g.addEventListener("click",()=>{!function(e){if(!e)return;document.getElementById("championName").textContent=e.champion.name,document.getElementById("championClass").textContent=e.champion.class;const t=document.getElementById("championIcon");t&&e.champion.id&&(t.src=`images/champions/${e.champion.id}.png`,t.alt=e.champion.name,t.title=e.champion.name,t.style.display="block"),document.getElementById("summonerSpell1").textContent=e.spell1.name;const n=document.getElementById("spell1Icon");n&&e.spell1.id&&(n.src=`images/spells/${e.spell1.id}.png`,n.alt=e.spell1.name,n.title=e.spell1.name,n.style.display="block"),document.getElementById("summonerSpell2").textContent=e.spell2.name;const o=document.getElementById("spell2Icon");o&&e.spell2.id&&(o.src=`images/spells/${e.spell2.id}.png`,o.alt=e.spell2.name,o.title=e.spell2.name,o.style.display="block");for(let t=0;t<6;t++){document.getElementById(`item${t+1}`).textContent=e.items[t].name;const n=document.getElementById(`item${t+1}Icon`);n&&e.items[t].id&&(n.src=`images/items/${e.items[t].id}.png`,n.alt=e.items[t].name,n.title=e.items[t].name,n.style.display="block")}if(e.champion.abilities&&Array.isArray(e.abilityPriorityOrder)&&e.abilityPriorityOrder.forEach((t,n)=>{const o=e.champion.abilities[t],l=document.getElementById(`abilityIcon${n+1}`),s=document.getElementById(`abilityLabel${n+1}`);l&&o&&(l.src=o.icon,l.alt=o.name,l.title=`${t}: ${o.name}`,l.style.display="block"),s&&(s.textContent=t)}),e.runePage){document.getElementById("runePrimaryName").textContent=e.runePage.primaryTree.name,document.getElementById("runeSecondaryName").textContent=e.runePage.secondaryTree.name;const t=document.getElementById("runePrimaryTreeIcon");t&&(t.src=`${a}${e.runePage.primaryTree.icon}`,t.alt=e.runePage.primaryTree.name,t.title=e.runePage.primaryTree.name,t.style.display="block");const n=document.getElementById("runeSecondaryTreeIcon");n&&(n.src=`${a}${e.runePage.secondaryTree.icon}`,n.alt=e.runePage.secondaryTree.name,n.title=e.runePage.secondaryTree.name,n.style.display="block"),e.runePage.primaryRunes.forEach((e,t)=>{const n=document.getElementById(`runePrimary${t+1}`);n&&e&&(n.src=`${a}${e.icon}`,n.alt=e.name,n.title=e.name,n.style.display="block")}),e.runePage.secondaryRunes.forEach((e,t)=>{const n=document.getElementById(`runeSecondary${t+1}`);n&&e&&(n.src=`${a}${e.icon}`,n.alt=e.name,n.title=e.name,n.style.display="block")})}document.getElementById("results").style.display="grid"}(y())}),document.getElementById("gameMode").addEventListener("change",()=>{c(),document.getElementById("results").style.display="none"}),async function(){p(!1);try{await async function(){const[t,n,a,i,m]=await Promise.all([fetch("data/champions.json").then(e=>e.json()),fetch("data/summoner-spells.json").then(e=>e.json()),fetch("data/items.json").then(e=>e.json()),fetch("data/runes.json").then(e=>e.json()),fetch("data/metadata.json").then(e=>e.json()).catch(()=>({version:"Unknown"}))]);e=t,o=n,l=a,s=i,r=m,r&&r.version&&(document.getElementById("patchVersion").textContent=`Patch ${r.version}`),c()}(),p(!0)}catch(e){console.error("Failed to load data files.",e)}}()})();