<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>League of Legends Ultimate Bravery</title>
    <style>
        /* League of Legends Ultimate Bravery Stylesheet */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: 16px;
            line-height: 1.6;
            color: #e0e1de;
        }

        body {
            background: linear-gradient(135deg, #0a1428 0%, #162650 50%, #1a3a52 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(10, 20, 40, 0.8);
            border: 2px solid #c89b3c;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 0 30px rgba(200, 155, 60, 0.3), inset 0 0 20px rgba(200, 155, 60, 0.1);
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 2px solid #c89b3c;
        }

        header h1 {
            font-size: 3em;
            color: #c89b3c;
            text-shadow: 0 0 20px rgba(200, 155, 60, 0.8), 2px 2px 4px rgba(0, 0, 0, 0.8);
            margin-bottom: 10px;
            letter-spacing: 2px;
        }

        .subtitle {
            font-size: 1.2em;
            color: #a8925f;
            font-style: italic;
        }

        .patch-version {
            font-size: 0.9em;
            color: #5b8ec6;
            margin-top: 10px;
            font-weight: bold;
        }

        .game-mode-selector {
            margin-top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .game-mode-selector label {
            color: #c89b3c;
            font-size: 1em;
            font-weight: bold;
        }

        .game-mode-selector select {
            padding: 8px 16px;
            border: 2px solid #c89b3c;
            border-radius: 6px;
            background: rgba(30, 40, 70, 0.8);
            color: #e0e1de;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .game-mode-selector select:hover {
            border-color: #d4af37;
            background: rgba(30, 40, 70, 1);
        }

        .game-mode-selector select:focus {
            outline: none;
            border-color: #e5c158;
            box-shadow: 0 0 10px rgba(200, 155, 60, 0.5);
        }

        main {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }

        .roll-button, .reroll-button {
            font-size: 1.3em;
            padding: 20px 50px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 2px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }

        .roll-button {
            background: linear-gradient(135deg, #c89b3c 0%, #d4af37 100%);
            color: #0a1428;
        }

        .roll-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 30px rgba(200, 155, 60, 0.6);
            background: linear-gradient(135deg, #d4af37 0%, #e5c158 100%);
        }

        .roll-button:active {
            transform: translateY(-1px);
        }

        .reroll-button {
            background: linear-gradient(135deg, #5b8ec6 0%, #4a7aa8 100%);
            color: #e0e1de;
            margin-top: 10px;
        }

        .reroll-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 30px rgba(91, 142, 198, 0.6);
            background: linear-gradient(135deg, #6a9ad8 0%, #5b8ec6 100%);
        }

        .reroll-button:active {
            transform: translateY(-1px);
        }

        .results {
            width: 100%;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }

        .section {
            background: rgba(30, 40, 70, 0.8);
            border: 2px solid #5b8ec6;
            border-radius: 8px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(91, 142, 198, 0.3);
            transition: all 0.3s ease;
        }

        .section:hover {
            border-color: #c89b3c;
            box-shadow: 0 6px 20px rgba(200, 155, 60, 0.4);
            transform: translateY(-3px);
        }

        .section h2 {
            font-size: 1.8em;
            color: #c89b3c;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 0 0 10px rgba(200, 155, 60, 0.5);
        }

        .champion-section {
            grid-column: 1 / -1;
        }

        .champion-card {
            background: rgba(91, 142, 198, 0.2);
            padding: 25px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid #c89b3c;
        }

        .champion-icon {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 3px solid #c89b3c;
            margin: 0 auto 15px;
            box-shadow: 0 0 20px rgba(200, 155, 60, 0.5);
        }

        .champion-card h3 {
            font-size: 2.5em;
            color: #c89b3c;
            margin-bottom: 10px;
            text-shadow: 0 0 15px rgba(200, 155, 60, 0.7);
        }

        .champion-card p {
            font-size: 1.1em;
            color: #a8925f;
            font-style: italic;
        }

        .spell-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .spell-card {
            background: rgba(91, 142, 198, 0.2);
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #c89b3c;
            text-align: center;
        }

        .spell-icon {
            width: 64px;
            height: 64px;
            border-radius: 8px;
            border: 2px solid #c89b3c;
            margin: 10px auto;
            display: block;
        }

        .spell-card h4 {
            color: #c89b3c;
            margin-bottom: 10px;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .spell-card p {
            font-size: 1.1em;
            color: #e0e1de;
            font-weight: bold;
        }

        .build-items {
            display: grid;
            grid-template-columns: repeat(3, minmax(0, 1fr));
            gap: 15px;
        }

        .item-slot {
            background: rgba(91, 142, 198, 0.2);
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #c89b3c;
            text-align: center;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-width: 0;
        }

        .item-icon {
            width: 48px;
            height: 48px;
            border-radius: 6px;
            border: 2px solid #c89b3c;
            margin: 8px auto;
        }

        .slot-label {
            font-size: 0.8em;
            color: #c89b3c;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }

        .item-slot p {
            font-size: 0.95em;
            color: #e0e1de;
            font-weight: 500;
            line-height: 1.3;
            overflow-wrap: anywhere;
            word-break: break-word;
        }

        .priority-card {
            background: rgba(91, 142, 198, 0.2);
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #c89b3c;
            text-align: center;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .priority-card p {
            color: #c89b3c;
            font-size: 1.3em;
            font-weight: bold;
            margin-top: 5px;
        }

        .priority-text-card {
            text-align: center;
            margin-top: 15px;
        }

        .priority-text-card p {
            color: #c89b3c;
            font-size: 1.3em;
            font-weight: bold;
            margin: 0;
        }

        .ability-icons {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .ability-icon-slot {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .ability-icon {
            width: 48px;
            height: 48px;
            border-radius: 6px;
            border: 2px solid #c89b3c;
            margin-bottom: 5px;
        }

        .rune-tree {
            margin-bottom: 20px;
        }

        .rune-tree-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .rune-tree-icon {
            width: 40px;
            height: 40px;
            border-radius: 4px;
            border: 2px solid #c89b3c;
            margin-right: 10px;
        }

        .rune-row {
            display: flex;
            gap: 10px;
        }

        .rune-icon {
            width: 32px;
            height: 32px;
            border-radius: 4px;
            border: 2px solid #c89b3c;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            header h1 {
                font-size: 2em;
            }

            .results {
                grid-template-columns: 1fr;
            }

            .spell-grid {
                grid-template-columns: 1fr;
            }

            .build-items {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }

            .roll-button, .reroll-button {
                padding: 15px 40px;
                font-size: 1em;
            }
        }

        @media (max-width: 480px) {
            header h1 {
                font-size: 1.5em;
            }

            .champion-card h3 {
                font-size: 1.8em;
            }

            .build-items {
                grid-template-columns: minmax(0, 1fr);
            }

            .spell-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>‚öîÔ∏è League of Legends Ultimate Bravery ‚öîÔ∏è</h1>
            <p class="subtitle">Roll for a random champion, build, summoner spells, and ability leveling order</p>
            <p class="patch-version" id="patchVersion">Loading...</p>
            <div class="game-mode-selector">
                <label for="gameMode">Game Mode:</label>
                <select id="gameMode">
                    <option value="ARAM">ARAM (Howling Abyss)</option>
                    <option value="CLASSIC">Summoner's Rift</option>
                </select>
            </div>
        </header>

        <main>
            <button id="rollBtn" class="roll-button">üé≤ ROLL NOW</button>
            <button id="rerollBtn" class="reroll-button" style="display: none;">üîÑ REROLL</button>

            <div class="results" id="results" style="display: none;">
                <!-- Champion Section -->
                <div class="section champion-section">
                    <h2>Champion</h2>
                    <div class="champion-card">
                        <img id="championIcon" class="champion-icon" alt="Champion" style="display: none;">
                        <h3 id="championName"></h3>
                        <p id="championClass"></p>
                    </div>
                </div>

                <!-- Summoner Spells Section -->
                <div class="section summoner-spells-section">
                    <h2>Summoner Spells</h2>
                    <div class="spell-grid">
                        <div class="spell-card">
                            <h4>Spell 1</h4>
                            <img id="spell1Icon" class="spell-icon" alt="Spell 1" style="display: none;">
                            <p id="summonerSpell1"></p>
                        </div>
                        <div class="spell-card">
                            <h4>Spell 2</h4>
                            <img id="spell2Icon" class="spell-icon" alt="Spell 2" style="display: none;">
                            <p id="summonerSpell2"></p>
                        </div>
                    </div>
                </div>

                <!-- Ability Priority Section -->
                <div class="section ability-section">
                    <h2>Ability Priority</h2>
                    <div class="ability-icons">
                        <div class="ability-icon-slot">
                            <img id="abilityIcon1" class="ability-icon" alt="Priority 1" style="display: none;">
                            <span id="abilityLabel1" class="ability-label"></span>
                        </div>
                        <div class="ability-icon-slot">
                            <img id="abilityIcon2" class="ability-icon" alt="Priority 2" style="display: none;">
                            <span id="abilityLabel2" class="ability-label"></span>
                        </div>
                        <div class="ability-icon-slot">
                            <img id="abilityIcon3" class="ability-icon" alt="Priority 3" style="display: none;">
                            <span id="abilityLabel3" class="ability-label"></span>
                        </div>
                    </div>
                    <div class="priority-text-card">
                        <p id="abilityPriority"></p>
                    </div>
                </div>

                <!-- Rune Page Section -->
                <div class="section rune-section">
                    <h2>Rune Page</h2>
                    <div class="rune-tree">
                        <div class="rune-tree-header">
                            <img id="runePrimaryTreeIcon" class="rune-tree-icon" alt="Primary Tree" style="display: none;">
                            <span id="runePrimaryName"></span>
                        </div>
                        <div class="rune-row">
                            <img id="runePrimary1" class="rune-icon" alt="Primary Rune 1" style="display: none;">
                            <img id="runePrimary2" class="rune-icon" alt="Primary Rune 2" style="display: none;">
                            <img id="runePrimary3" class="rune-icon" alt="Primary Rune 3" style="display: none;">
                            <img id="runePrimary4" class="rune-icon" alt="Primary Rune 4" style="display: none;">
                        </div>
                    </div>
                    <div class="rune-tree">
                        <div class="rune-tree-header">
                            <img id="runeSecondaryTreeIcon" class="rune-tree-icon" alt="Secondary Tree" style="display: none;">
                            <span id="runeSecondaryName"></span>
                        </div>
                        <div class="rune-row">
                            <img id="runeSecondary1" class="rune-icon" alt="Secondary Rune 1" style="display: none;">
                            <img id="runeSecondary2" class="rune-icon" alt="Secondary Rune 2" style="display: none;">
                        </div>
                    </div>
                </div>

                <!-- Build Section -->
                <div class="section build-section">
                    <h2>Recommended Build</h2>
                    <div class="build-items">
                        <div class="item-slot">
                            <span class="slot-label">Item 1</span>
                            <img id="item1Icon" class="item-icon" alt="Item 1" style="display: none;">
                            <p id="item1"></p>
                        </div>
                        <div class="item-slot">
                            <span class="slot-label">Item 2</span>
                            <img id="item2Icon" class="item-icon" alt="Item 2" style="display: none;">
                            <p id="item2"></p>
                        </div>
                        <div class="item-slot">
                            <span class="slot-label">Item 3</span>
                            <img id="item3Icon" class="item-icon" alt="Item 3" style="display: none;">
                            <p id="item3"></p>
                        </div>
                        <div class="item-slot">
                            <span class="slot-label">Item 4</span>
                            <img id="item4Icon" class="item-icon" alt="Item 4" style="display: none;">
                            <p id="item4"></p>
                        </div>
                        <div class="item-slot">
                            <span class="slot-label">Item 5</span>
                            <img id="item5Icon" class="item-icon" alt="Item 5" style="display: none;">
                            <p id="item5"></p>
                        </div>
                        <div class="item-slot">
                            <span class="slot-label">Item 6</span>
                            <img id="item6Icon" class="item-icon" alt="Item 6" style="display: none;">
                            <p id="item6"></p>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <footer>
            <p>League of Legends Ultimate Bravery - Accept the Challenge!</p>
            <p>Champion data is randomly selected. May your bravery be rewarded! üéÆ</p>
        </footer>
    </div>

    <script>
        let champions = [];
        let summonerSpells = [];
        let items = [];
        let allSummonerSpells = [];
        let allItems = [];
        let runes = [];
        let metadata = null;

        const RUNE_ICON_BASE = 'https://ddragon.leagueoflegends.com/cdn/img/';

        const itemConstraints = {
            requiredBootsCount: 1,
            bootsFirst: true, // Ensure boots is always the first item
            mutuallyExclusivePairs: [
                ['Manamune', 'Muramana']
            ]
        };

        async function loadData() {
            const [championsData, summonerData, itemsData, runesData, metadataData] = await Promise.all([
                fetch('data/champions.json').then((response) => response.json()),
                fetch('data/summoner-spells.json').then((response) => response.json()),
                fetch('data/items.json').then((response) => response.json()),
                fetch('data/runes.json').then((response) => response.json()),
                fetch('data/metadata.json').then((response) => response.json()).catch(() => ({ version: 'Unknown' }))
            ]);

            champions = championsData;
            allSummonerSpells = summonerData;
            allItems = itemsData;
            runes = runesData;
            metadata = metadataData;

            // Display patch version
            if (metadata && metadata.version) {
                document.getElementById('patchVersion').textContent = `Patch ${metadata.version}`;
            }

            // Initialize with default game mode
            updateGameModeData();
        }

        function updateGameModeData() {
            const gameMode = document.getElementById('gameMode').value;
            const mapId = gameMode === 'ARAM' ? '12' : '11';

            // Filter items by map
            items = allItems.filter(item => item.maps && item.maps[mapId]);

            // Filter summoner spells by mode
            summonerSpells = allSummonerSpells.filter(spell =>
                spell.modes && spell.modes.includes(gameMode)
            );
        }

        function getRandomElement(arr) {
            return arr[Math.floor(Math.random() * arr.length)];
        }

        function buildMutualExclusionMap(pairs) {
            const map = new Map();
            for (const [first, second] of pairs) {
                if (!map.has(first)) {
                    map.set(first, new Set());
                }
                if (!map.has(second)) {
                    map.set(second, new Set());
                }
                map.get(first).add(second);
                map.get(second).add(first);
            }
            return map;
        }

        function isBootsItem(item) {
            return Array.isArray(item.tags) && item.tags.includes('Boots');
        }

        function canSelectItem(item, selected, constraints, exclusionMap) {
            if (constraints.requiredBootsCount !== undefined) {
                const bootsCount = selected.filter(isBootsItem).length;
                if (isBootsItem(item) && bootsCount >= constraints.requiredBootsCount) {
                    return false;
                }
            }

            const exclusions = exclusionMap.get(item.name);
            if (exclusions) {
                for (const picked of selected) {
                    if (exclusions.has(picked.name)) {
                        return false;
                    }
                }
            }

            return true;
        }

        function selectItemsWithConstraints(pool, count, constraints) {
            const exclusionMap = buildMutualExclusionMap(constraints.mutuallyExclusivePairs || []);
            const available = [...pool];
            const selected = [];

            // If bootsFirst is true, select boots as the first item
            if (constraints.bootsFirst) {
                const bootsCandidates = available.filter(
                    (item) => isBootsItem(item) && canSelectItem(item, selected, constraints, exclusionMap)
                );
                if (!bootsCandidates.length) {
                    return null;
                }
                const bootsItem = getRandomElement(bootsCandidates);
                selected.push(bootsItem);
                available.splice(available.indexOf(bootsItem), 1);
            }

            // Select remaining items (excluding boots if we already selected one)
            while (selected.length < count) {
                const candidates = available.filter((item) =>
                    !isBootsItem(item) && canSelectItem(item, selected, constraints, exclusionMap)
                );
                if (!candidates.length) {
                    return null;
                }
                const pick = getRandomElement(candidates);
                selected.push(pick);
                available.splice(available.indexOf(pick), 1);
            }

            return selected;
        }

        function generateAbilityPriorityString() {
            const abilities = ['Q', 'W', 'E'];
            for (let i = abilities.length - 1; i > 0; i--) {
                const swapIndex = Math.floor(Math.random() * (i + 1));
                [abilities[i], abilities[swapIndex]] = [abilities[swapIndex], abilities[i]];
            }
            return abilities;
        }

        function generateRunePage() {
            if (!Array.isArray(runes) || runes.length < 2) {
                return null;
            }

            const primaryTree = getRandomElement(runes);
            let secondaryTree = getRandomElement(runes);
            while (secondaryTree.id === primaryTree.id) {
                secondaryTree = getRandomElement(runes);
            }

            const primarySlots = primaryTree.slots || [];
            const primaryRunes = primarySlots.map((slot) => getRandomElement(slot.runes || []));

            const secondarySlots = (secondaryTree.slots || []).slice(1);
            const slotIndexes = [0, 1, 2].filter((i) => secondarySlots[i]);
            const firstIndex = getRandomElement(slotIndexes);
            const remainingIndexes = slotIndexes.filter((i) => i !== firstIndex);
            const secondIndex = getRandomElement(remainingIndexes);

            const secondaryRunes = [
                getRandomElement(secondarySlots[firstIndex].runes || []),
                getRandomElement(secondarySlots[secondIndex].runes || [])
            ];

            return {
                primaryTree,
                secondaryTree,
                primaryRunes,
                secondaryRunes
            };
        }

        function roll() {
            if (!champions.length || !summonerSpells.length || !items.length) {
                return null;
            }

            const champion = getRandomElement(champions);
            const spell1 = getRandomElement(summonerSpells);
            let spell2 = getRandomElement(summonerSpells);
            while (spell2 === spell1) {
                spell2 = getRandomElement(summonerSpells);
            }

            let selectedItems = selectItemsWithConstraints(items, 6, itemConstraints);
            if (!selectedItems) {
                // Fallback: ensure boots is still first
                selectedItems = [];
                const availableItems = [...items];

                // Select boots first
                const bootsItems = availableItems.filter(item => isBootsItem(item));
                if (bootsItems.length > 0) {
                    const bootsItem = getRandomElement(bootsItems);
                    selectedItems.push(bootsItem);
                    availableItems.splice(availableItems.indexOf(bootsItem), 1);
                }

                // Select remaining items
                while (selectedItems.length < 6 && availableItems.length > 0) {
                    const randomIndex = Math.floor(Math.random() * availableItems.length);
                    selectedItems.push(availableItems[randomIndex]);
                    availableItems.splice(randomIndex, 1);
                }
            }

            const abilityPriorityOrder = generateAbilityPriorityString();
            const abilityPriority = abilityPriorityOrder.join(' > ');
            const runePage = generateRunePage();

            return { champion, spell1, spell2, items: selectedItems, abilityPriority, abilityPriorityOrder, runePage };
        }

        function displayResults(data) {
            if (!data) {
                return;
            }

            document.getElementById('championName').textContent = data.champion.name;
            document.getElementById('championClass').textContent = data.champion.class;

            const championIcon = document.getElementById('championIcon');
            if (championIcon && data.champion.id) {
                championIcon.src = `images/champions/${data.champion.id}.png`;
                championIcon.alt = data.champion.name;
                championIcon.style.display = 'block';
            }

            document.getElementById('summonerSpell1').textContent = data.spell1.name;
            const spell1Icon = document.getElementById('spell1Icon');
            if (spell1Icon && data.spell1.id) {
                spell1Icon.src = `images/spells/${data.spell1.id}.png`;
                spell1Icon.alt = data.spell1.name;
                spell1Icon.style.display = 'block';
            }

            document.getElementById('summonerSpell2').textContent = data.spell2.name;
            const spell2Icon = document.getElementById('spell2Icon');
            if (spell2Icon && data.spell2.id) {
                spell2Icon.src = `images/spells/${data.spell2.id}.png`;
                spell2Icon.alt = data.spell2.name;
                spell2Icon.style.display = 'block';
            }

            for (let i = 0; i < 6; i++) {
                document.getElementById(`item${i + 1}`).textContent = data.items[i].name;
                const itemIcon = document.getElementById(`item${i + 1}Icon`);
                if (itemIcon && data.items[i].id) {
                    itemIcon.src = `images/items/${data.items[i].id}.png`;
                    itemIcon.alt = data.items[i].name;
                    itemIcon.style.display = 'block';
                }
            }

            // Display ability icons
            for (let i = 1; i <= 3; i++) {
                const abilityIcon = document.getElementById(`abilityIcon${i}`);
                const abilityLabel = document.getElementById(`abilityLabel${i}`);
                if (abilityIcon && abilityLabel && data.abilityPriorityOrder) {
                    const letter = data.abilityPriorityOrder[i - 1];
                    const ability = data.champion.abilities[letter];
                    if (ability) {
                        abilityIcon.src = ability.icon;
                        abilityIcon.alt = ability.name;
                        abilityIcon.style.display = 'block';
                    }
                    abilityLabel.textContent = letter;
                }
            }

            // Display rune page
            if (data.runePage) {
                document.getElementById('runePrimaryName').textContent = data.runePage.primaryTree.name;
                document.getElementById('runeSecondaryName').textContent = data.runePage.secondaryTree.name;

                const primaryTreeIcon = document.getElementById('runePrimaryTreeIcon');
                if (primaryTreeIcon) {
                    primaryTreeIcon.src = `${RUNE_ICON_BASE}${data.runePage.primaryTree.icon}`;
                    primaryTreeIcon.alt = data.runePage.primaryTree.name;
                    primaryTreeIcon.style.display = 'block';
                }

                const secondaryTreeIcon = document.getElementById('runeSecondaryTreeIcon');
                if (secondaryTreeIcon) {
                    secondaryTreeIcon.src = `${RUNE_ICON_BASE}${data.runePage.secondaryTree.icon}`;
                    secondaryTreeIcon.alt = data.runePage.secondaryTree.name;
                    secondaryTreeIcon.style.display = 'block';
                }

                data.runePage.primaryRunes.forEach((rune, index) => {
                    const runeIcon = document.getElementById(`runePrimary${index + 1}`);
                    if (runeIcon && rune) {
                        runeIcon.src = `${RUNE_ICON_BASE}${rune.icon}`;
                        runeIcon.alt = rune.name;
                        runeIcon.style.display = 'block';
                    }
                });

                data.runePage.secondaryRunes.forEach((rune, index) => {
                    const runeIcon = document.getElementById(`runeSecondary${index + 1}`);
                    if (runeIcon && rune) {
                        runeIcon.src = `${RUNE_ICON_BASE}${rune.icon}`;
                        runeIcon.alt = rune.name;
                        runeIcon.style.display = 'block';
                    }
                });
            }

            document.getElementById('results').style.display = 'grid';
            document.getElementById('rerollBtn').style.display = 'block';
        }

        const rollButton = document.getElementById('rollBtn');
        const rerollButton = document.getElementById('rerollBtn');

        function setButtonsEnabled(isEnabled) {
            rollButton.disabled = !isEnabled;
            rerollButton.disabled = !isEnabled;
        }

        async function initialize() {
            setButtonsEnabled(false);
            try {
                await loadData();
                setButtonsEnabled(true);
            } catch (error) {
                console.error('Failed to load data files.', error);
            }
        }

        rollButton.addEventListener('click', () => {
            const data = roll();
            displayResults(data);
        });

        rerollButton.addEventListener('click', () => {
            const data = roll();
            displayResults(data);
        });

        document.getElementById('gameMode').addEventListener('change', () => {
            updateGameModeData();
            // Clear results when changing game mode
            document.getElementById('results').style.display = 'none';
        });

        initialize();
    </script>
</body>
</html>

