(()=>{let e=[],n=[],t=[],s=[],a=[],l=[],o=null;const i="https://ddragon.leagueoflegends.com/cdn/img/",r=document.getElementById("tooltip");function c(e,n){const t=12,s=r.offsetWidth,a=r.offsetHeight,l=e+t+s>window.innerWidth?e-s-t:e+t,o=n+t+a>window.innerHeight?n-a-t:n+t;r.style.left=`${l}px`,r.style.top=`${o}px`}function m(e,n,t){e.addEventListener("mouseenter",s=>{e.lastMouseX=s.clientX,e.lastMouseY=s.clientY,function(e,n,t){const s=`<span class="tt-name">${n}</span>`,a=(l=t)?l.replace(/<mainText>/gi,"").replace(/<\/mainText>/gi,"").replace(/<stats>([\s\S]*?)<\/stats>/gi,'<span class="lol-stats">$1</span>').replace(/<attention>([\s\S]*?)<\/attention>/gi,'<span class="lol-attention">$1</span>').replace(/<passive>([\s\S]*?)<\/passive>/gi,'<span class="lol-passive">$1</span>').replace(/<active>([\s\S]*?)<\/active>/gi,'<span class="lol-active">$1</span>').replace(/<physicalDamage>([\s\S]*?)<\/physicalDamage>/gi,'<span class="lol-physical">$1</span>').replace(/<magicDamage>([\s\S]*?)<\/magicDamage>/gi,'<span class="lol-magic">$1</span>').replace(/<trueDamage>([\s\S]*?)<\/trueDamage>/gi,'<span class="lol-true">$1</span>').replace(/<speed>([\s\S]*?)<\/speed>/gi,'<span class="lol-speed">$1</span>').replace(/<status>([\s\S]*?)<\/status>/gi,'<span class="lol-status">$1</span>').replace(/<rules>([\s\S]*?)<\/rules>/gi,'<span class="lol-rules">$1</span>').replace(/<OnHit>([\s\S]*?)<\/OnHit>/gi,'<span class="lol-onhit">$1</span>').replace(/<scaleMana>([\s\S]*?)<\/scaleMana>/gi,'<span class="lol-scale-mana">$1</span>').replace(/<lol-uikit-tooltipped-keyword[^>]*>([\s\S]*?)<\/lol-uikit-tooltipped-keyword>/gi,'<span class="lol-keyword">$1</span>').replace(/<(?!\/?(?:b|i|br|li|font|span)[^>]*>)[^>]+>/gi,"").replace(/<font color='([^']+)'>([\s\S]*?)<\/font>/gi,'<span style="color:$1">$2</span>'):"";var l;r.innerHTML=a?`${s}<span class="tt-desc">${a}</span>`:s,r.style.display="block",c(e.lastMouseX||0,e.lastMouseY||0)}(e,n,t)}),e.addEventListener("mousemove",n=>{e.lastMouseX=n.clientX,e.lastMouseY=n.clientY,c(n.clientX,n.clientY)}),e.addEventListener("mouseleave",()=>{r.style.display="none"})}const d={requiredBootsCount:1,bootsFirst:!0,mutuallyExclusiveGroups:[["Ravenous Hydra","Titanic Hydra","Profane Hydra"]],mutuallyExclusivePairs:[["Manamune","Muramana"]]};function p(){const e=document.getElementById("gameMode").value,l="ARAM"===e?"12":"11";t=a.filter(e=>e.maps&&e.maps[l]),n=s.filter(n=>n.modes&&n.modes.includes(e))}function u(e){return e[Math.floor(Math.random()*e.length)]}function y(e){return Array.isArray(e.tags)&&e.tags.includes("Boots")}function g(e,n,t,s,a){if(void 0!==t.requiredBootsCount){const s=n.filter(y).length;if(y(e)&&s>=t.requiredBootsCount)return!1}if(e.rangedOnly&&a&&!a.ranged)return!1;const l=s.get(e.name);if(l)for(const e of n)if(l.has(e.name))return!1;return!0}function f(){if(!e.length||!n.length||!t.length)return null;const s=u(e),a=u(n);let o=u(n);for(;o===a;)o=u(n);let i=function(e,n,t,s){const a=function(e,n){const t=new Map;for(const[n,s]of e||[])t.has(n)||t.set(n,new Set),t.has(s)||t.set(s,new Set),t.get(n).add(s),t.get(s).add(n);for(const e of n||[])for(const n of e){t.has(n)||t.set(n,new Set);for(const s of e)s!==n&&t.get(n).add(s)}return t}(t.mutuallyExclusivePairs||[],t.mutuallyExclusiveGroups||[]),l=[...e],o=[];if(t.bootsFirst){const e=l.filter(e=>y(e)&&g(e,o,t,a,s));if(!e.length)return null;const n=u(e);o.push(n),l.splice(l.indexOf(n),1)}for(;o.length<n;){const e=l.filter(e=>!y(e)&&g(e,o,t,a,s));if(!e.length)return null;const n=u(e);o.push(n),l.splice(l.indexOf(n),1)}return o}(t,6,d,s);if(!i){i=[];const e=t.filter(e=>!e.rangedOnly||s.ranged),n=e.filter(e=>y(e));if(n.length>0){const t=u(n);i.push(t),e.splice(e.indexOf(t),1)}const a=e.filter(e=>!y(e));for(;i.length<6&&a.length>0;){const e=Math.floor(Math.random()*a.length);i.push(a[e]),a.splice(e,1)}}const r=function(){const e=["Q","W","E"];for(let n=e.length-1;n>0;n--){const t=Math.floor(Math.random()*(n+1));[e[n],e[t]]=[e[t],e[n]]}return e}(),c=function(){if(!Array.isArray(l)||l.length<2)return null;const e=u(l);let n=u(l);for(;n.id===e.id;)n=u(l);const t=(e.slots||[]).map(e=>u(e.runes||[])),s=(n.slots||[]).slice(1),a=[0,1,2].filter(e=>s[e]),o=u(a),i=u(a.filter(e=>e!==o));return{primaryTree:e,secondaryTree:n,primaryRunes:t,secondaryRunes:[u(s[o].runes||[]),u(s[i].runes||[])]}}();return{champion:s,spell1:a,spell2:o,items:i,abilityPriorityOrder:r,runePage:c}}const h=document.getElementById("rollBtn");function $(e){h.disabled=!e}h.addEventListener("click",()=>{!function(e){if(!e)return;document.getElementById("championName").textContent=e.champion.name,document.getElementById("championClass").textContent=e.champion.class;const n=document.getElementById("championIcon");n&&e.champion.id&&(n.src=`images/champions/${e.champion.id}.png`,n.alt=e.champion.name,n.style.display="block",m(n,e.champion.name,"")),document.getElementById("summonerSpell1").textContent=e.spell1.name;const t=document.getElementById("spell1Icon");t&&e.spell1.id&&(t.src=`images/spells/${e.spell1.id}.png`,t.alt=e.spell1.name,t.style.display="block",m(t,e.spell1.name,e.spell1.description)),document.getElementById("summonerSpell2").textContent=e.spell2.name;const s=document.getElementById("spell2Icon");s&&e.spell2.id&&(s.src=`images/spells/${e.spell2.id}.png`,s.alt=e.spell2.name,s.style.display="block",m(s,e.spell2.name,e.spell2.description));for(let n=0;n<6;n++){document.getElementById(`item${n+1}`).textContent=e.items[n].name;const t=document.getElementById(`item${n+1}Icon`);t&&e.items[n].id&&(t.src=`images/items/${e.items[n].id}.png`,t.alt=e.items[n].name,t.style.display="block",m(t,e.items[n].name,e.items[n].description))}if(e.champion.abilities&&Array.isArray(e.abilityPriorityOrder)&&e.abilityPriorityOrder.forEach((n,t)=>{const s=e.champion.abilities[n],a=document.getElementById(`abilityIcon${t+1}`),l=document.getElementById(`abilityLabel${t+1}`);a&&s&&(a.src=s.icon,a.alt=s.name,a.style.display="block",m(a,s.name,s.description||"")),l&&(l.textContent=n)}),e.runePage){document.getElementById("runePrimaryName").textContent=e.runePage.primaryTree.name,document.getElementById("runeSecondaryName").textContent=e.runePage.secondaryTree.name;const n=document.getElementById("runePrimaryTreeIcon");n&&(n.src=`${i}${e.runePage.primaryTree.icon}`,n.alt=e.runePage.primaryTree.name,n.style.display="block",m(n,e.runePage.primaryTree.name,""));const t=document.getElementById("runeSecondaryTreeIcon");t&&(t.src=`${i}${e.runePage.secondaryTree.icon}`,t.alt=e.runePage.secondaryTree.name,t.style.display="block",m(t,e.runePage.secondaryTree.name,"")),e.runePage.primaryRunes.forEach((e,n)=>{const t=document.getElementById(`runePrimary${n+1}`);t&&e&&(t.src=`${i}${e.icon}`,t.alt=e.name,t.style.display="block",m(t,e.name,e.shortDesc||""))}),e.runePage.secondaryRunes.forEach((e,n)=>{const t=document.getElementById(`runeSecondary${n+1}`);t&&e&&(t.src=`${i}${e.icon}`,t.alt=e.name,t.style.display="block",m(t,e.name,e.shortDesc||""))})}document.getElementById("results").style.display="grid"}(f())}),document.getElementById("gameMode").addEventListener("change",()=>{p(),document.getElementById("results").style.display="none"}),async function(){$(!1);try{await async function(){const[n,t,i,r,c]=await Promise.all([fetch("data/champions.json").then(e=>e.json()),fetch("data/summoner-spells.json").then(e=>e.json()),fetch("data/items.json").then(e=>e.json()),fetch("data/runes.json").then(e=>e.json()),fetch("data/metadata.json").then(e=>e.json()).catch(()=>({version:"Unknown"}))]);e=n,s=t,a=i,l=r,o=c,o&&o.version&&(document.getElementById("patchVersion").textContent=`Patch ${o.version}`),p()}(),$(!0)}catch(e){console.error("Failed to load data files.",e)}}()})();